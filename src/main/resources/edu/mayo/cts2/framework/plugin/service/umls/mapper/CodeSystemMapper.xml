<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="edu.mayo.cts2.framework.plugin.service.umls.mapper.CodeSystemMapper">

  <select id="getRootSourceDTO" 
  	resultType="edu.mayo.cts2.framework.plugin.service.umls.mapper.RootSourceDTO" 
  	parameterType="string">
    SELECT
    	rs.ABBREVIATION as abbreviation, 
    	rs.SHORT_NAME AS shortName,
    	cil.VALUE AS licenseContact,
    	cic.VALUE AS contentContact
    FROM ROOT_SOURCES rs
    INNER JOIN
    	CONTACT_INFORMATION cil
    ON
    	rs.LICENSE_CONTACT = cil.ID
    INNER JOIN
    	CONTACT_INFORMATION cic
    ON
    	rs.CONTENT_CONTACT = cic.ID
    WHERE
    	rs.ABBREVIATION = #{sab}
  </select>
  
    <select id="searchRootSourceDTO" 
  	resultType="edu.mayo.cts2.framework.plugin.service.umls.mapper.RootSourceDTO" 
  	parameterType="string">
    SELECT
    	rs.ABBREVIATION as abbreviation, 
    	rs.SHORT_NAME AS shortName,
    	cil.VALUE AS licenseContact,
    	cic.VALUE AS contentContact
    FROM ROOT_SOURCES rs
    INNER JOIN
    	CONTACT_INFORMATION cil
    ON
    	rs.LICENSE_CONTACT = cil.ID
    INNER JOIN
    	CONTACT_INFORMATION cic
    ON
    	rs.CONTENT_CONTACT = cic.ID
    WHERE
    	<if test="searchObject.abbreviation != null">
    	rs.ABBREVIATION LIKE #{searchObject.abbreviation}
    	</if>
    	AND
    	<if test="searchObject.shortName != null">
    	rs.SHORT_NAME LIKE #{searchObject.shortName}
    	</if>
    	
  </select>

</mapper>