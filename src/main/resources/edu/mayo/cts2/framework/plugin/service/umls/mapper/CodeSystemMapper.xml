<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="edu.mayo.cts2.framework.plugin.service.umls.mapper.CodeSystemMapper">

  <select id="getRootSourceDTO" 
  	resultType="edu.mayo.cts2.framework.plugin.service.umls.mapper.RootSourceDTO" 
  	parameterType="string">
    SELECT
    	rs.ABBREVIATION as abbreviation, 
    	rs.SHORT_NAME AS shortName,
    	cil.VALUE AS licenseContact,
    	cic.VALUE AS contentContact
    FROM ROOT_SOURCES rs
    INNER JOIN
    	CONTACT_INFORMATION cil
    ON
    	rs.LICENSE_CONTACT = cil.ID
    INNER JOIN
    	CONTACT_INFORMATION cic
    ON
    	rs.CONTENT_CONTACT = cic.ID
    WHERE
    	rs.ABBREVIATION = #{sab}
  </select>
  
  <select id="streamEntities" 
  	resultType="edu.mayo.cts2.framework.plugin.service.umls.mapper.AtomRowDTO">
		select 
			c.UI as UI, 
			c.ROOT_SOURCE as ROOTSOURCE, 
			s.NAME as STRING 
		from Codes c
		inner join
			Atoms a on c.id = a.code_id
		inner join
			String_Info s on a.string_info_id = s.id
		order by c.ui
  </select>

</mapper>